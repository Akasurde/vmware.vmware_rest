---
- name: Get boot device info
  vcenter_vm_hardware_boot_device_info:
    vm: '{{ test_vm1_info.id }}'
  register: _result

- debug: var=_result

- assert:
    that:
      - _result.value == []
      - not (_result is changed)

# Fails with
# fatal: [localhost]: FAILED! => {"_debug_info": {"operation": "set", "status": 400}, "changed": false, "type": "com.vmware.vapi.std.errors.invalid_argument", "value": {"error_type": "INVALID_ARGUMENT", "messages": [{"args": [], "default_message": "A specified parameter was not correct: configSpec.bootOptions.bootOrder", "id": "vmsg.InvalidArgument.summary"}]}}
- name: Set a boot device
  vcenter_vm_hardware_boot_device:
    vm: '{{ test_vm1_info.id }}'
    devices:
      - type: "CDROM"
  register: _result
- debug: var=_result

- assert:
    that:
      - _result is changed


- name: Get boot device info (again)
  vcenter_vm_hardware_boot_device_info:
    vm: '{{ test_vm1_info.id }}'
  register: _result

- debug: var=_result
- assert:
    that:
      - '_result.value == [{"type": "CDROM"}]'
